<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=  1.0">
   <title>E-SHOP</title>




   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
   <link rel="stylesheet" href="https://cdn.datatables.net/1.13.2/css/dataTables.bootstrap.min.css">
   <link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.3.1/css/fixedHeader.bootstrap.min.css">
   <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.bootstrap.min.css">
   <style type="text/css" rel="stylesheet">
      @import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&display=swap');

      * {
         margin: 0;
         padding: 0;
         box-sizing: border-box;
         font-family: 'Ubuntu', sans-serif;
      }

      :root {
         --blue: #287bff;
         --white: #fff;
         --gray: #f5f5f5;
         --black1: #222;
         --black2: #999;
      }

      body {
         min-height: 100vh;
         overflow-x: hidden;
         background: var(--blue);
      }

      img {
         margin: 0 auto;
         width: 100px;
         height: 100px;
         display: block;
         margin-left: auto;
         margin-right: auto;
      }

      .container {
         position: relative;
         width: 100%;
      }

      .navigation {
         position: fixed;
         width: 300px;
         height: 100%;
         background: var(--blue);
         border-left: 10px solid var(--blue);
         transition: 0.5s;
         overflow: hidden;
      }

      .navigation.active {
         width: 200px;
      }

      .navigation ul {
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
      }

      .navigation ul li {
         position: relative;
         width: 100%;
         list-style: none;
         margin-top: 30px;
         border-top-left-radius: 30px;
         border-bottom-left-radius: 30px;
      }

      /* .navigation ul li:hovered, */
      .navigation ul li:hover,
      .navigation ul li.hovered,
      .navigation ul li.hovered2 {
         background: var(--white);
      }

      .navigation ul li:nth-child(1) {
         margin-bottom: 40px;
         pointer-events: none;
      }

      .navigation ul li a {
         position: relative;
         display: block;
         width: 100%;
         display: flex;
         text-decoration: none;
         color: var(--white);
      }

      /* .navigation ul li:hovered a, */
      .navigation ul li:hover a,
      .navigation ul li.hovered a,
      .navigation ul li.hovered2 a {
         color: var(--blue);
      }

      /* .navigation ul li.hovered a {
      background: var(--white);
   } */

      .navigation ul li a .icon {
         position: relative;
         display: block;
         min-width: 60px;
         height: 60px;
         line-height: 70px;
         text-align: center;
      }

      .navigation ul li a .icon ion-icon {
         font-size: 1.75em
      }

      .navigation ul li a .title {
         position: relative;
         display: block;
         padding: 0 10px;
         height: 60px;
         line-height: 60px;
         text-align: start;
         white-space: nowrap;
      }

      /* curve outside */
      /* .navigation ul li:hovered a::before, */
      .navigation ul li:hover a::before,
      .navigation ul li.hovered a::before,
      .navigation ul li.hovered2 a::before {
         content: '';
         position: absolute;
         right: 0;
         top: -50px;
         width: 50px;
         height: 50px;
         background: transparent;
         border-radius: 50%;
         box-shadow: 35px 35px 0 10px var(--white);
         pointer-events: none;
      }

      /* .navigation ul li:hovered a::after, */
      .navigation ul li:hover a::after,
      .navigation ul li.hovered a::after,
      .navigation ul li.hovered2 a::after {
         content: '';
         position: absolute;
         right: 0;
         bottom: -50px;
         width: 50px;
         height: 50px;
         background: transparent;
         border-radius: 50%;
         box-shadow: 35px -35px 0 10px var(--white);
         pointer-events: none;
      }

      .main {
         position: absolute;
         width: calc(100% - 300px);
         left: 300px;
         min-height: 100vh;
         background: var(--white);
         transition: 0.5s;
      }

      .main.active {
         width: calc(100% - 80px);
         left: 80px;
      }

      .topbar {
         width: 100%;
         height: 60px;
         display: flex;
         justify-content: space-between;
         align-items: center;
         padding: 0 10px;
      }

      .toggle {
         position: relative;
         top: 0;
         width: 60px;
         height: 60px;
         display: flex;
         background: var(--white);
         justify-content: center;
         align-items: center;
         font-size: 2.5em;
         cursor: pointer;
      }

      .search {
         position: relative;
         width: 400px;
         margin: 0 10px;
      }


      .user {
         position: relative;
         min-width: 40px;
         height: 40px;
         border-radius: 50%;
         overflow: hidden;
         cursor: pointer;
      }

      .user img {
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         object-fit: cover;
      }

      .cardBox {
         position: relative;
         width: 100%;
         padding: 20px;
         display: grid;
         grid-template-columns: repeat(4, 1fr);
      }

      .cardBox .card {
         position: relative;
         background: var(--white);
         padding: 30px;
         border-radius: 20px;
         display: flex;
         justify-content: space-between;
         box-shadow: 0 7px 25px rgba(0, 0, 0, 0.08);
      }

      .cardBox .card .numbers {
         position: relative;
         font-weight: 500;
         font-size: 2.5em;
         color: var(--blue);
      }

      .cardBox .card .cardName {
         color: var(--black2);
         font-size: 1.1em;
         margin-top: 5px;
      }

      .cardBox .card .iconBx {
         font-size: 3.5em;
         color: var(--black2);
      }

      .cardBox .card:hover {
         background: var(--blue);
      }

      .cardBox .card:hover .numbers,
      .cardBox .card:hover .cardName,
      .cardBox .card:hover .iconBx {
         color: var(--white)
      }

      .details {
         position: relative;
         width: 100%;
         padding: 20px;
         display: grid;
         /* grid-template-columns: 2fr 1fr; */
         grid-gap: 30px;
         margin-top: 10px;
      }

      .details .recentOrders {
         position: relative;
         display: grid;
         min-height: 500px;
         background: var(--white);
         padding: 20px;
         box-shadow: 0 7px 25px rgba(0, 0, 0, 0.08);
         border-radius: 20px;
      }

      .cardHeader {
         display: flex;
         justify-content: space-between;
         align-items: flex-start;
      }

      .cardHeader h2 {
         font-weight: 600;
         color: var(--blue);
      }

      .btn {
         position: relative;
         padding: 5px 10px;
         background: var(--blue);
         text-decoration: none;
         color: var(--white);
         border-radius: 6px;
         margin: 0 0 0 10px;
      }

      .details table {
         width: 100%;
         border-collapse: collapse;
         margin-top: 10px
      }

      .details table thead td {
         font-weight: 600;
      }

      .details .recentOrders table tr {
         color: var(--black1);
         border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .details .recentOrders table tr:last-child {
         border-bottom: none;
      }

      .details .recentOrders table tbody tr:hover {
         background: var(--blue);
         color: var(--white);
      }

      .details .recentOrders table tr td {
         padding: 10px;
      }

      .details .recentOrders table tr td:last-child {
         text-align: end;
      }

      .details .recentOrders table tr td:nth-child(2) {
         text-align: end;
      }

      .details .recentOrders table tr td:nth-child(3) {
         text-align: center;
      }

      .status.delivered {
         padding: 2px 4px;
         background: #8de02c;
         color: var(--white);
         border-radius: 4px;
         font-size: 14px;
         font-weight: 500;
      }

      .status.pending {
         padding: 2px 4px;
         background: #f9ca3f;
         color: var(--white);
         border-radius: 4px;
         font-size: 14px;
         font-weight: 500;
      }

      .status.return {
         padding: 2px 4px;
         background: #f00;
         color: var(--white);
         border-radius: 4px;
         font-size: 14px;
         font-weight: 500;
      }

      .status.inprogress {
         padding: 2px 4px;
         background: #1795ce;
         color: var(--white);
         border-radius: 4px;
         font-size: 14px;
         font-weight: 500;
      }

      table,
      th,
      td {
         border: 1px solid black;
      }

      /* now, make it responsive design */
      @media (max-width: 991px) {
         .navigation {
            left: -300px;
         }

         .navigation.active {
            width: 300px;
            left: 0;
         }

         .main {
            width: 100%;
            left: 0;
         }

         .main.active {
            left: 300px;
         }

         .cardBox {
            grid-template-columns: repeat(2, 1fr);
         }
      }

      @media (max-width: 768px) {
         .details {
            grid-template-columns: repeat(1, 1fr);
         }

         .recentOrders {
            overflow-x: auto;
         }

         .status.inprogress {
            white-space: nowrap;
         }
      }

      /* The Modal (background) */
      .modal {
         display: none;
         /* Hidden by default */
         position: fixed;
         /* Stay in place */
         z-index: 1;
         /* Sit on top */
         padding-top: 100px;
         /* Location of the box */
         left: 0;
         top: 0;
         width: 100%;
         /* Full width */
         height: 100%;
         /* Full height */
         overflow: auto;
         /* Enable scroll if needed */
         background-color: rgb(0, 0, 0);
         /* Fallback color */
         background-color: rgba(0, 0, 0, 0.4);
         /* Black w/ opacity */
      }

      /* Modal Content */
      .modal-content {
         background-color: #fefefe;
         margin: auto;
         padding: 20px;
         border: 1px solid #888;
         width: 80%;
      }

      /* The Close Button */
      .close,
      .close2 {
         color: #aaaaaa;
         float: right;
         font-size: 28px;
         font-weight: bold;
      }

      .close:hover,
      .close:focus,
      .close2:hover,
      .close2:focus {
         color: #000;
         text-decoration: none;
         cursor: pointer;
      }

      /* Modal Picker */

      .img2 {
         border: 1px solid black;
         display: inline-block;
      }

      .input[type=text] {
         width: 100%;
         padding: 12px 20px;
         margin: 8px 0;
         box-sizing: border-box;
         border: none;
         background-color: var(--gray);
         color: rgb(0, 0, 0);
      }

      .input[type=number] {
         width: 100%;
         padding: 12px 20px;
         margin: 8px 0;
         box-sizing: border-box;
         border: none;
         background-color: var(--gray);
         color: rgb(0, 0, 0);
      }

      .input[type=file] {
         padding: 12px 20px;
         margin: 8px 0;
         background-color: var(--gray);
      }
   </style>

</head>

<body>
   <div class="container">

      <!-- navigation -->
      <%- include('./common/navigation') %>

         <!-- main -->
         <div class="main">
            <div class="topbar">
               <div class="toggle">
                  <ion-icon name="menu-outline"></ion-icon>
               </div>

            </div>
            <!-- Bảng thông tin sản phẩm -->
         <div class="details">
            <table id="example" class="table table-striped table-bordered nowrap">
               <thead>
                  <tr>
                     <td>Mã đơn</td>
                     <td>Tên</td>
                     <td>SĐT</td>
                     <td>Điểm giao</td>
                     <td>Tổng tiền</td>
                     <td>Trạng thái</td>
                     <td>Ngày tạo</td>
                     <td>Chi tiết</td>
                  </tr>
               </thead>
               <tbody>
                  <% orders.forEach((item, index)=> { %>

                     <tr>
                        <td>
                           <%=index + 1000%>
                        </td>
                        <td>
                           <%= item.name %>
                        </td>
                        <td>
                           <%= item.phone_number %>
                        </td>
                        <td>
                           <%= item.delivery_address %>
                        </td>

                        <td>
                           <%= item.total_price.toLocaleString() + " đ" %>
                        </td>
                        <td>
                           <% if (item.status==0) { %>
                              <span class="status pending">Chờ xử lý</span>
                              <% } else if (item.status !==0) { %>
                                 <td><span class="status inprogress">aa</span></td>
                                 <% } %>
                        </td>
                        <td>
                           <%=item.createdAt.toLocaleDateString()%>
                        </td>
                        <td>
                           <button type="button" class="btn btn-success">
                              <a style="text-decoration:none; color: #fefefe;" href="/order/<%=item._id %>">Sửa</a>
                           </button>
                        </td>
                     </tr>
                     <% }) %>
               </tbody>
            </table>
         </div>
         </div>
         

         
   </div>

   <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
   <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
   <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
   <script src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>
   <script src="https://cdn.datatables.net/1.13.2/js/dataTables.bootstrap.min.js"></script>
   <script src="https://cdn.datatables.net/fixedheader/3.3.1/js/dataTables.fixedHeader.min.js"></script>
   <script src="https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js"></script>
   <script src="https://cdn.datatables.net/responsive/2.4.0/js/responsive.bootstrap.min.js"></script>

   <!-- DataTable -->
   <script>
      // Datatables
      $(document).ready(function () {
         var table = $('#example').DataTable({
            responsive: true
         });
         new $.fn.dataTable.FixedHeader(table);
      });   
   </script>
   <!-- Modal picker -->
   <script>
      // Get the modal
      var modal = document.getElementById("myModal");
      // Get the button that opens the modal
      var btn = document.getElementById("myBtn");
      // Get the <span> element that closes the modal
      var span = document.getElementsByClassName("close")[0];

      // When the user clicks the button, open the modal 
      btn.onclick = function () {
         modal.style.display = "block";
      }

      // When the user clicks on <span> (x), close the modal
      span.onclick = function () {
         modal.style.display = "none";
         localStorage.clear();
      }

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function (event) {
         if (event.target == modal) {
            modal.style.display = "none";
            localStorage.clear();
         }
      }
   </script>

   <!-- Navigation -->
   <script>
      let toggle = document.querySelector('.toggle');
      let navigation = document.querySelector('.navigation');
      let main = document.querySelector('.main');

      toggle.onclick = function () {
         navigation.classList.toggle('active');
         main.classList.toggle('active');
      }

      //add hovered class in selected list item
      let list = document.querySelectorAll(".navigation li");
      function activeLink() {
         list.forEach((item) =>
            item.classList.remove("hovered"));
         this.classList.add("hovered");
      }
      list.forEach((item) =>
         item.addEventListener('mouseover', activeLink));
   </script>
   <script>
      // Modal Picker
      let sizeList = [];
      const todo = document.getElementById("todo");

      function addTodo() {
         // get input
         const size = document.getElementById("size").value;
         const quantity = document.getElementById("quantity").value;
         // return if nothing was entered
         if (!size || !quantity) return;
         // add the new task to todo list
         sizeList.push({
            size: size,
            quantity: quantity,
         });

         // add the todo list to localstorage
         localStorage.setItem("sizes", JSON.stringify(sizeList));
         // render todo list
      }

      function Read() {
         // clear the list
         todo.innerHTML = null;

         const sizes = localStorage.getItem("sizes");
         sizeList = JSON.parse(sizes) || [];
         const details = document.getElementById("details").value = sizes;

         if (sizeList != null) {
            for (let index = 0; index < sizeList.length; index++) {
               todo.innerHTML += ` 
               <tr>
                  <td>${sizeList[index].size}</td>
                  <td>${sizeList[index].quantity}</td>
               </tr>
                  `
            }
         }
      }

      function readURL(input) {
         if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
               $('#blah').attr('src', e.target.result);
            }

            reader.readAsDataURL(input.files[0]);
         }
      }

      $("#imageUrl").change(function () {
         readURL(this);
      });

      function onClickEvent(cart,iduser) {
         alert(cart)
      }
   </script>
</body>

</html>